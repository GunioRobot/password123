/*
 jQuery password123: iPhone Style Passwords Plugin - v1.4 - 11/23/2010
 http://timmywillison.com/samples/password123/
 Copyright (c) 2010 timmy willison
 Dual licensed under the MIT and GPL licences.
 http://timmywillison.com/licence/
*/
(function(d,m,k,g){d.fn.password123=function(a){return this.map(function(b,c){return new i.init(c,a)})};var l=m.clearTimeout,n=0,i={init:function(a,b){if(!a.type==="password")return a;var c=this;if(typeof b==="string"&&c[b]&&b.charAt(0)!=="_")return c[b](a,b);c.opts=d.extend({character:"&#8226;",delay:2E3,prefix:"iField",placeholder:true,placeholderClass:"place",maskInitial:false},b);c.encodedChar=d("<div>"+c.opts.character+"</div>").text();c.$field=c._replaceField(a).bind("textchange",function(){c._letterChange.call(c)});
c.opts.placeholder&&c._bindPlaceholder();c.opts.maskInitial&&c.$field.keyup();return c.$field[0]},_replaceField:function(a){var b=d(a),c=b.attr("placeholder")||g,e=this.opts.prefix+n++,f=b.val()||(this.opts.placeholder?c||"":"");e={"class":this.opts.placeholder&&c!==g&&(f===c||f==="")?a.className+" "+this.opts.placeholderClass:a.className,id:e,value:f,placeholder:this.opts.placeholder?g:c};for(var j=["size","tabindex","readonly","disabled","maxlength"],h=0;h<j.length;h++)e[j[h]]=b.attr(j[h]);this.$hidden=
d('<input type="hidden"/>').attr({name:b.attr("name"),id:a.id,"class":a.className,disabled:b.attr("disabled")}).replaceAll(b).val(f!==c?f:"");this.$oldField=b;return d('<input type="text"/>').attr(e).insertAfter(this.$hidden).data({value:b.val()||"",placeholder:c,newVal:f,password123:this})},_letterChange:function(){var a=this.$field.val();if(a.length>this.$field.data("value").length)this.$field.data("value",this._fieldChange());else if(a.length<this.$field.data("value").length){l(this.last);var b=
this.$hidden.val();if(a.length<b.length-1)b=b.substr(0,a.length);else{var c=this._getCursorPosition();b=b.length>c+1&&c>-1?b.slice(0,c).concat(b.slice(c+1)):b.slice(0,c)}this.$field.data({value:a,newVal:b});b!==this.$field.data("placeholder")&&this.$hidden.val(b)}},_fieldChange:function(){var a=this;l(a.last);var b=a.$field.val(),c=b.length,e=a.$hidden.val(),f=a._getCursorPosition();e=e.length>f+1&&f>-1?e.substr(0,f-1)+b.charAt(f-1)+e.substr(f-1):e+b.charAt(c-1);a.$field.data("newVal",e);e!==a.$field.data("placeholder")&&
a.$hidden.val(e);if(c>1){for(e=0;e<c-1;e++)b=b.replace(b.charAt(e),a.encodedChar);a.$field.val(b)}if(c>0)a.last=setTimeout(function(){f=a._getCursorPosition();b=a.$field.val();b=b.replace(b.charAt(c-1),a.encodedChar);a.$field.val(b).data("value",b);f!=c&&a._setCursorPosition(f)},a.opts.delay);f!=c&&a._setCursorPosition(f);return b},_bindPlaceholder:function(){var a=this,b=a.$field.data("placeholder");b!==g?a.$field.focus(function(){if(a.$field.data("newVal")===b){a.$field.val("").removeClass(a.opts.placeholderClass).data("newVal",
"");a.$hidden.val("")}}).blur(function(){if(b!==g&&a.$field.val()===""){a.$field.val(b).addClass(a.opts.placeholderClass).data("newVal",b);a.opts.maskInitial&&a.$field.keyup()}}):a.$field.keyup()},_getCursorPosition:function(){var a=this.$field[0];if(a!=null)if(k.selection){a.focus();var b=k.selection.createRange();b.moveStart("character",-a.value.length);return b.text.length}else if(a.selectionStart||a.selectionStart=="0")return a.selectionStart;return-1},_setCursorPosition:function(a){var b=this.$field[0];
if(b!=null)if(b.createTextRange){b=b.createTextRange();b.move("character",a);b.select()}else if(b.selectionStart){b.focus();b.setSelectionRange(a,a)}else b.focus()},destroy:function(a){a=d(a);var b=a.data("password123"),c=b.$hidden.remove().val();return b.$oldField.val(c).replaceAll(a)[0]}};i.init.prototype=i;d.event.special.textchange={setup:function(){d(this).bind("keyup.textchange",d.event.special.textchange.handler);d(this).bind("cut.textchange paste.textchange input.textchange",d.event.special.textchange.delayedHandler)},
teardown:function(){d(this).unbind(".textchange")},handler:function(){d.event.special.textchange.triggerIfChanged(d(this))},delayedHandler:function(){var a=d(this);setTimeout(function(){d.event.special.textchange.triggerIfChanged(a)},25)},triggerIfChanged:function(a){var b=a.val();if(a.val()!==a.data("lastValue")){var c=a.data("password123");if(b.length>1&&b.indexOf(c.encodedChar)===-1){b=b.substr(0,b.length-1);a.data("value",b);c.$hidden.val(b)}a.trigger("textchange",a.data("lastValue"));a.data("lastValue",
a.val())}}}})(jQuery,this,this.document);
