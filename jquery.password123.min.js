/*
 jQuery password123: iPhone Style Passwords Plugin - v1.3 - 11/23/2010
 http://timmywillison.com/samples/password123/
 Copyright (c) 2010 timmy willison
 Dual licensed under the MIT and GPL licences.
 http://timmywillison.com/licence/
*/
(function(g,l,k){function m(a){if(a!=null)if(o.selection){a.focus();var b=o.selection.createRange();b.moveStart("character",-a.value.length);return b.text.length}else if(a.selectionStart||a.selectionStart=="0")return a.selectionStart;return-1}function p(a,b){if(a!=null)if(a.createTextRange){var c=a.createTextRange();c.move("character",b);c.select()}else if(a.selectionStart){a.focus();a.setSelectionRange(b,b)}else a.focus()}function q(a){var b=[];a.each(function(c,e){var d=g(e),f=d.attr("placeholder")||
k,i=h.prefix+c,j=d.attr("value")||(h.placeholder?f||"":""),r=h.placeholder&&f!==k&&(j===f||j==="")?d.attr("class")+" "+h.placeholderClass:d.attr("class");i=g('<input type="text"/>').attr({"class":r,id:i,value:j,size:d.attr("size"),tabindex:d.attr("tabindex"),readonly:d.attr("readonly"),disabled:d.attr("disabled"),maxlength:d.attr("maxlength"),placeholder:h.placeholder?k:f}).insertAfter(d).data({value:d.attr("value")||"",placeholder:f,newVal:j})[0];b.push(i);g('<input type="hidden"/>').attr({name:d.attr("name"),
id:d.attr("id"),"class":d.attr("class"),disabled:d.attr("disabled")}).replaceAll(d).val(j!==f?j:"")});return g(b)}function s(){var a=g(this),b=a.val();if(b.length>a.data("value").length)a.data("value",t(a));else if(b.length<a.data("value").length){l.clearTimeout(n);var c=a.prev("input").val();if(b.length<c.length-1)c=c.substr(0,b.length);else{var e=m(a[0]);c=c.length>e+1&&e>-1?c.slice(0,e).concat(c.slice(e+1)):c.slice(0,e)}a.data({value:b,newVal:c});c!==a.data("placeholder")&&a.prev("input").val(c)}}
function t(a){l.clearTimeout(n);var b=a.val(),c=b.length,e=a.prev("input"),d=e.val(),f=m(a[0]),i=g("<div>"+h.character+"</div>").text();d=d.length>f+1&&f>-1?d.substr(0,f-1)+b.charAt(f-1)+d.substr(f-1):d+b.charAt(c-1);a.data("newVal",d);d!==a.data("placeholder")&&e.val(d);if(c>1){for(e=0;e<c-1;e++)b=b.replace(b.charAt(e),i);a.val(b)}if(c>0)n=setTimeout(function(){f=m(a[0]);b=a.val();b=b.replace(b.charAt(c-1),i);a.val(b).data("value",b);f!=c&&p(a[0],f)},h.delay);f!=c&&p(a[0],f);return b}function u(a){a.each(function(b,
c){var e=g(c),d=e.prev("input"),f=e.data("placeholder");f!==k?e.focus(function(){if(e.data("newVal")===f){e.val("").removeClass(h.placeholderClass).data("newVal","");d.val("")}}).blur(function(){if(f!==k&&e.val()===""){e.val(f).addClass(h.placeholderClass).data("newVal",f);h.maskInitial&&e.keyup()}}):e.keyup()})}var o=l.document,n,h={character:"&#8226;",delay:2E3,prefix:"iField",placeholder:true,placeholderClass:"place",maskInitial:false};g.event.special.textchange={setup:function(){g(this).bind("keyup.textchange",
g.event.special.textchange.handler);g(this).bind("cut.textchange paste.textchange input.textchange",g.event.special.textchange.delayedHandler)},teardown:function(){g(this).unbind(".textchange")},handler:function(){g.event.special.textchange.triggerIfChanged(g(this))},delayedHandler:function(){var a=g(this);setTimeout(function(){g.event.special.textchange.triggerIfChanged(a)},25)},triggerIfChanged:function(a){var b=a.val(),c=g("<div>"+h.character+"</div>").text();if(a.val()!==a.data("lastValue")){if(b.length>
1&&b.indexOf(c)===-1){b=b.substr(0,b.length-1);a.data("value",b).prev("input").val(b)}a.trigger("textchange",a.data("lastValue"));a.data("lastValue",a.val())}}};g.fn.textchange=function(a){return a?this.bind("textchange",a):this.trigger("textchange")};if(g.attrFn)g.attrFn.textchange=true;g.fn.password123=function(a){h=jQuery.extend(h,a);a=q(this);a.textchange(s);h.placeholder&&u(a);h.maskInitial&&a.keyup();return a}})(jQuery,this);
