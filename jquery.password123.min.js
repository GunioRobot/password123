/*
 * jQuery password123: iPhone Style Passwords Plugin - v1.0 - 7/4/2010
 * http://timmywillison.com/samples/password123/password123.html
 * 
 * Copyright (c) 2010 timmy willison
 * Dual licensed under the MIT and GPL licences.
 * http://timmywillison.com/licence/
 */
(function(e,h,i,c){var b,l,a={character:"&#8226;",delay:2000,prefix:"iField"};e.event.special.textchange={setup:function(n,m){e(this).bind("keyup.textchange",e.event.special.textchange.handler);e(this).bind("cut.textchange paste.textchange input.textchange",e.event.special.textchange.delayedHandler)},teardown:function(m){e(this).unbind(".textchange")},handler:function(m){e.event.special.textchange.triggerIfChanged(e(this))},delayedHandler:function(n){var m=e(this);setTimeout(function(){e.event.special.textchange.triggerIfChanged(m)},25)},triggerIfChanged:function(m){var o=m.val(),n=e("<div>"+a.character+"</div>").text();if(m.val()!==m.data("lastValue")){if(o.length>1&&o.indexOf(n)===-1){o=o.substr(0,o.length-1);m.data("value",o).prev("input").val(o)}m.trigger("textchange",m.data("lastValue"));m.data("lastValue",m.val())}}};e.fn.textchange=function(m){return m?this.bind("textchange",m):this.trigger("textchange")};if(e.attrFn){e.attrFn.textchange=true}function k(n){if(n!=null){if(i.selection){n.focus();var m=i.selection.createRange();m.moveStart("character",-n.value.length);return m.text.length}else{if(n.selectionStart||n.selectionStart=="0"){return n.selectionStart}else{return -1}}}}function d(n,o){if(n!=null){if(n.createTextRange){var m=n.createTextRange();m.move("character",o);m.select()}else{if(n.selectionStart){n.focus();n.setSelectionRange(o,o)}else{n.focus()}}}}function g(n){var m=[];e(n).each(function(p,o){var r=e(o),q=a.prefix+p;e('<input type="text"/>').attr({"class":r.attr("class"),id:q,value:r.attr("value")}).insertAfter(r);m.push(i.getElementById(q));e('<input type="hidden"/>').attr({name:r.attr("name"),id:r.attr("id"),"class":r.attr("class")}).replaceAll(r)});return e(m).data("value","")}function f(){var o=e(this);var r=o.val();if(r.length>o.data("value").length){o.data("value",j(o))}else{if(r.length<o.data("value").length){h.clearTimeout(l);var p=o.prev("input"),m=p.val(),n;if(r.length<m.length-1){n=m.substr(0,r.length)}else{var q=k(o[0]);n=m.length>q+1&&q>-1?m.slice(0,q).concat(m.slice(q+1)):m.slice(0,q)}o.data("value",r).prev("input").val(n)}}}function j(u){h.clearTimeout(l);var o=u.val(),r=o.length,q=u.prev("input"),s=e("<div>"+a.character+"</div>").text(),n=q.val(),t=k(u[0]),m;m=n.length>t+1&&t>-1?n.substr(0,t-1)+o.charAt(t-1)+n.substr(t-1):n+o.charAt(r-1);q.val(m);if(r>1){for(var p=0;p<r-1;p++){o=o.replace(o.charAt(p),s)}u.val(o)}if(r>0){l=setTimeout(function(){t=k(u[0]);o=u.val();o=o.replace(o.charAt(r-1),s);u.val(o).data("value",o);if(t!=r){d(u[0],t)}},a.delay)}if(t!=r){d(u[0],t)}return o}e.fn.password123=function(m){a=jQuery.extend(a,m);b=g(this);b.textchange(f);b.keyup();return b}})(jQuery,this,document);