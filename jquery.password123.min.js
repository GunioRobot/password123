/*
*   jQuery password123: iPhone Style Passwords Plugin - v1.2 - 10/5/2010
*   http://timmywillison.com/samples/password123/
*   Copyright (c) 2010 timmy willison
*   Dual licensed under the MIT and GPL licences.
*   http://timmywillison.com/licence/
*/
(function(d,o,l,j){function m(a){if(a!=null)if(l.selection){a.focus();var b=l.selection.createRange();b.moveStart("character",-a.value.length);return b.text.length}else if(a.selectionStart||a.selectionStart=="0")return a.selectionStart;return-1}function p(a,b){if(a!=null)if(a.createTextRange){var c=a.createTextRange();c.move("character",b);c.select()}else if(a.selectionStart){a.focus();a.setSelectionRange(b,b)}else a.focus()}function q(a){var b=[];a.each(function(c,e){var f=d(e),h=g.prefix+c,i=f.attr("placeholder")||
j,k=f.attr("value")||(g.placeholder?i||"":"");d('<input type="text"/>').attr({"class":g.placeholder&&i!==j&&(k===i||k==="")?f.attr("class")+" "+g.placeholderClass:f.attr("class"),id:h,value:k,placeholder:g.placeholder?j:i}).insertAfter(f).data("value",f.attr("value")||"").data("placeholder",i);b.push(l.getElementById(h));d('<input type="hidden"/>').attr({name:f.attr("name"),id:f.attr("id"),"class":f.attr("class")}).replaceAll(f).val(k)});return d(b)}function r(){var a=d(this),b=a.val();if(b.length>
a.data("value").length)a.data("value",s(a));else if(b.length<a.data("value").length){o.clearTimeout(n);var c=a.prev("input").val();if(b.length<c.length-1)c=c.substr(0,b.length);else{var e=m(a[0]);c=c.length>e+1&&e>-1?c.slice(0,e).concat(c.slice(e+1)):c.slice(0,e)}a.data("value",b).prev("input").val(c)}}function s(a){o.clearTimeout(n);var b=a.val(),c=b.length,e=a.prev("input"),f=e.val(),h=m(a[0]),i=d("<div>"+g.character+"</div>").text();f=f.length>h+1&&h>-1?f.substr(0,h-1)+b.charAt(h-1)+f.substr(h-
1):f+b.charAt(c-1);e.val(f);if(c>1){for(e=0;e<c-1;e++)b=b.replace(b.charAt(e),i);a.val(b)}if(c>0)n=setTimeout(function(){h=m(a[0]);b=a.val();b=b.replace(b.charAt(c-1),i);a.val(b).data("value",b);h!=c&&p(a[0],h)},g.delay);h!=c&&p(a[0],h);return b}function t(a){a.each(function(){var b=d(this),c=b.prev("input"),e=b.data("placeholder");e!==j?b.focus(function(){if(c.val()===e){b.val("").removeClass(g.placeholderClass);c.val("")}}).blur(function(){if(e!==j&&b.val()===""){b.val(e).addClass(g.placeholderClass).prev("input").val(e).end();
g.maskInitial&&b.keyup()}}):b.keyup()})}var n,g={character:"&#8226;",delay:2E3,prefix:"iField",placeholder:true,placeholderClass:"place",maskInitial:false};d.event.special.textchange={setup:function(){d(this).bind("keyup.textchange",d.event.special.textchange.handler);d(this).bind("cut.textchange paste.textchange input.textchange",d.event.special.textchange.delayedHandler)},teardown:function(){d(this).unbind(".textchange")},handler:function(){d.event.special.textchange.triggerIfChanged(d(this))},
delayedHandler:function(){var a=d(this);setTimeout(function(){d.event.special.textchange.triggerIfChanged(a)},25)},triggerIfChanged:function(a){var b=a.val(),c=d("<div>"+g.character+"</div>").text();if(a.val()!==a.data("lastValue")){if(b.length>1&&b.indexOf(c)===-1){b=b.substr(0,b.length-1);a.data("value",b).prev("input").val(b)}a.trigger("textchange",a.data("lastValue"));a.data("lastValue",a.val())}}};d.fn.textchange=function(a){return a?this.bind("textchange",a):this.trigger("textchange")};if(d.attrFn)d.attrFn.textchange=
true;d.fn.password123=function(a){g=jQuery.extend(g,a);a=q(this);a.textchange(r);g.placeholder&&t(a);g.maskInitial&&a.keyup();return a}})(jQuery,this,document);
